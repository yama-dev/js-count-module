/*!
 * JS COUNT MODULE (JavaScript Library)
 *   @yama-dev/js-count-module
 * Version 0.2.0
 * Repository https://github.com/yama-dev/js-count-module
 * Copyright yama-dev
 * Licensed MIT
 */
!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var e=i();for(var n in e)("object"==typeof exports?exports:t)[n]=e[n]}}(window,function(){return function(t){var i={};function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(i){return t[i]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";function n(){return(n=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}).apply(this,arguments)}function o(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e.r(i),e.d(i,"JS_COUNT_MODULE",function(){return a});var a=function(){function t(){var i=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var o={type:"down",interval:1e3,autostart:!0,nowObj:new Date,data:[],endstop:!0,date:"",onUpdate:null,onComplete:null,countDiffMilliSec:0,countDiffObj:{},countDiffListObj:{},equalRacio:0,setObj:new Date,elapsedTime:0,state:{updating:!0,pause:!1}};if(this.Config=n(o,e),this.Config.interval<1&&(this.Config.interval=1),this.Config.nowObj?this.Config.nowObjFix=this.Config.nowObj:this.Config.nowObjFix=new Date,"up"==this.Config.type&&(this.Config.nowObjFix.setTime(1),this.Config.date=this.Config.nowObjFix.getTime()),!this.Config.data.length&&!this.Config.date){try{throw new Error('Not config "date"')}catch(t){console.log(t.name+": "+t.message)}return!1}this.Config.data.length||(this.Config.data=[{date:this.Config.date,onUpdate:this.Config.onUpdate,onComplete:this.Config.onComplete}]),"complete"==document.readyState||"interactive"==document.readyState?(this._updateData(),this.Config.autostart&&this.Update()):document.addEventListener("DOMContentLoaded",function(){i._updateData(),i.Config.autostart&&i.Update()})}var i,e,a;return i=t,a=[{key:"ParseTime2DateObj",value:function(t){var i=t,e={};return e.d=Math.floor(i/864e5),i%=864e5,e.h=Math.floor(i/36e5),i%=36e5,e.m=Math.floor(i/6e4),i%=6e4,e.s=Math.floor(i/1e3),i%=1e3,e.ms=i,e}},{key:"ParseTime2DateListObj",value:function(t){return{d:t/1e3/60/60/24,dFloor:Math.floor(t/1e3/60/60/24),dCeil:Math.ceil(t/1e3/60/60/24),dFloorSplit:String(Math.floor(t/1e3/60/60/24)).split(""),dCeilSplit:String(Math.ceil(t/1e3/60/60/24)).split(""),h:t/1e3/60/60,m:t/1e3/60,s:t/1e3,ms:t}}}],(e=[{key:"_checkEndstop",value:function(){"up"!==this.Config.type&&(this.Config.endstop?(this.Config.state.updating=!1,this.Config.countDiffMilliSec>0?this.Config.state.updating=!0:this.Config.countDiffMilliSec=0):this.Config.state.updating=!0)}},{key:"_updateData",value:function(){var i=this,e=this.Config.nowObjFix.getTime()+this.Config.elapsedTime;this.Config.setObj.setTime(e);var n=!1;this.Config.data.map(function(e){n||new Date(e.date)-i.Config.setObj>i.Config.equalRacio&&(n=!0,e.date&&(i.Config.date=e.date),e.onUpdate&&(i.Config.onUpdate=e.onUpdate),e.onComplete&&(i.Config.onComplete=e.onComplete),i.Config.countDiffMilliSec=new Date(e.date)-i.Config.setObj,i.Config.countDiffObj=t.ParseTime2DateObj(i.Config.countDiffMilliSec),i.Config.countDiffListObj=t.ParseTime2DateListObj(i.Config.countDiffMilliSec))})}},{key:"Update",value:function(){var i=this;this.Config.elapsedTime>=0&&this._checkEndstop(),this.Config.countDiffObj=t.ParseTime2DateObj(this.Config.countDiffMilliSec),this.Config.countDiffListObj=t.ParseTime2DateListObj(this.Config.countDiffMilliSec),this.Config.state.updating?this.OnUpdate():(this.OnUpdate(),this.OnComplete()),this.Config.countDiffMilliSec<=0&&this.Config.data.length&&(this._updateData(),this._checkEndstop()),this.instance=setTimeout(function(){i.Config.interval>0&&i.Config.state.updating&&(i.Config.interval>0&&(i.Config.elapsedTime+=i.Config.interval),"up"==i.Config.type?i.Config.countDiffMilliSec=i.Config.countDiffMilliSec+i.Config.interval:i.Config.countDiffMilliSec=i.Config.countDiffMilliSec-i.Config.interval,i.Update())},this.Config.interval)}},{key:"OnUpdate",value:function(){var t={updating:this.Config.state.updating,date:this.Config.date,onUpdate:this.Config.onUpdate,onComplete:this.Config.onComplete,diffObj:this.Config.countDiffListObj,diffObjParsed:this.Config.countDiffObj,diffMilliSec:this.Config.countDiffMilliSec,elapsedTime:this.Config.elapsedTime};this.Config.onUpdate&&this.Config.onUpdate(t)}},{key:"OnComplete",value:function(){var t={updating:this.Config.state.updating,date:this.Config.date,onUpdate:this.Config.onUpdate,onComplete:this.Config.onComplete,diffObj:this.Config.countDiffListObj,diffObjParsed:this.Config.countDiffObj,diffMilliSec:this.Config.countDiffMilliSec,elapsedTime:this.Config.elapsedTime};this.Config.onComplete&&this.Config.onComplete(t)}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.Config.nowObj;this.Config.state.updating=!0,this.Config.state.pause?this.Config.state.pause=!1:("down"==this.Config.type&&(this.Config.nowObjFix=t,this.Config.elapsedTime=0),"up"==this.Config.type&&(this.Config.nowObj.setTime(1),this.Config.date=this.Config.nowObj.getTime())),this._updateData(),this.Update()}},{key:"pause",value:function(){this.Config.state.updating=!1,this.Config.state.pause=!0,clearTimeout(this.instance)}},{key:"stop",value:function(){this.Config.state.updating=!1,clearTimeout(this.instance)}},{key:"destroy",value:function(){this.Config.state.updating=!1,clearTimeout(this.instance),this.instance=null,this.Config=null}}])&&o(i.prototype,e),a&&o(i,a),t}()}])});