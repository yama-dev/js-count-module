/*! @yama-dev/@yama-dev/js-count-module version:0.2.1 repository:https://github.com/yama-dev/js-count-module copyright:yama-dev licensed:MIT */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.r(e),i.d(e,"JS_COUNT_MODULE",(function(){return s})),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(t,e){return t>>=0,e=String(void 0!==e?e:" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}});var s=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,t);var n={type:"down",interval:1e3,autostart:!0,nowObj:new Date,data:[],endstop:!0,date:"",onUpdate:null,onComplete:null,countDiffMilliSec:0,countDiffObj:{},countDiffListObj:{},equalRacio:0,setObj:new Date,elapsedTime:0,state:{updating:!0,pause:!1}};if(this.config=o(o({},n),i),this.config.interval<1&&(this.config.interval=1),this.config.nowObj?this.config.nowObjFix=this.config.nowObj:this.config.nowObjFix=new Date,"up"==this.config.type&&(this.config.nowObjFix.setTime(1),this.config.date=this.config.nowObjFix.getTime()),!this.config.data.length&&!this.config.date){try{throw new Error('Not config "date"')}catch(t){console.log(t.name+": "+t.message)}return!1}this.config.data.length||(this.config.data=[{date:this.config.date,onUpdate:this.config.onUpdate,onComplete:this.config.onComplete}]),"complete"==document.readyState||"interactive"==document.readyState?(this._updateData(),this.config.autostart&&this.Update()):document.addEventListener("DOMContentLoaded",(function(){e._updateData(),e.config.autostart&&e.Update()}))}var e,i,n;return e=t,n=[{key:"PadStart",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return String(t).padStart(e,i)}},{key:"ParseTime2DateObj",value:function(e){var i=e,n={};return n.d=Math.floor(i/864e5),i%=864e5,n.h=Math.floor(i/36e5),i%=36e5,n.m=Math.floor(i/6e4),n.mm=t.PadStart(n.m,2,"0"),i%=6e4,n.s=Math.floor(i/1e3),n.ss=t.PadStart(n.s,2,"0"),i%=1e3,n.ms=i,n}},{key:"ParseTime2DateListObj",value:function(t){return{d:t/1e3/60/60/24,dFloor:Math.floor(t/1e3/60/60/24),dCeil:Math.ceil(t/1e3/60/60/24),dFloorSplit:String(Math.floor(t/1e3/60/60/24)).split(""),dCeilSplit:String(Math.ceil(t/1e3/60/60/24)).split(""),h:t/1e3/60/60,m:t/1e3/60,s:t/1e3,ms:t}}}],(i=[{key:"_checkEndstop",value:function(){"up"!==this.config.type&&(this.config.endstop?(this.config.state.updating=!1,this.config.countDiffMilliSec>0?this.config.state.updating=!0:this.config.countDiffMilliSec=0):this.config.state.updating=!0)}},{key:"_updateData",value:function(){var e=this,i=this.config.nowObjFix.getTime()+this.config.elapsedTime;this.config.setObj.setTime(i);var n=!1;this.config.data.map((function(i){n||new Date(i.date)-e.config.setObj>e.config.equalRacio&&(n=!0,i.date&&(e.config.date=i.date),i.onUpdate&&(e.config.onUpdate=i.onUpdate),i.onComplete&&(e.config.onComplete=i.onComplete),e.config.countDiffMilliSec=new Date(i.date)-e.config.setObj,e.config.countDiffObj=t.ParseTime2DateObj(e.config.countDiffMilliSec),e.config.countDiffListObj=t.ParseTime2DateListObj(e.config.countDiffMilliSec))}))}},{key:"Update",value:function(){var e=this;this.config.elapsedTime>=0&&this._checkEndstop(),this.config.countDiffObj=t.ParseTime2DateObj(this.config.countDiffMilliSec),this.config.countDiffListObj=t.ParseTime2DateListObj(this.config.countDiffMilliSec),this.config.state.updating?this.OnUpdate():(this.OnUpdate(),this.OnComplete()),this.config.countDiffMilliSec<=0&&this.config.data.length&&(this._updateData(),this._checkEndstop()),this.instance=setTimeout((function(){e.config.interval>0&&e.config.state.updating&&(e.config.interval>0&&(e.config.elapsedTime+=e.config.interval),"up"==e.config.type?e.config.countDiffMilliSec=e.config.countDiffMilliSec+e.config.interval:e.config.countDiffMilliSec=e.config.countDiffMilliSec-e.config.interval,e.Update())}),this.config.interval)}},{key:"OnUpdate",value:function(){var t={updating:this.config.state.updating,date:this.config.date,onUpdate:this.config.onUpdate,onComplete:this.config.onComplete,diffObj:this.config.countDiffListObj,diffObjParsed:this.config.countDiffObj,diffMilliSec:this.config.countDiffMilliSec,elapsedTime:this.config.elapsedTime};this.config.onUpdate&&this.config.onUpdate(t)}},{key:"OnComplete",value:function(){var t={updating:this.config.state.updating,date:this.config.date,onUpdate:this.config.onUpdate,onComplete:this.config.onComplete,diffObj:this.config.countDiffListObj,diffObjParsed:this.config.countDiffObj,diffMilliSec:this.config.countDiffMilliSec,elapsedTime:this.config.elapsedTime};this.config.onComplete&&this.config.onComplete(t)}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.nowObj;this.config.state.updating=!0,this.config.state.pause?this.config.state.pause=!1:("down"==this.config.type&&(this.config.nowObjFix=t,this.config.elapsedTime=0),"up"==this.config.type&&(this.config.nowObj.setTime(1),this.config.date=this.config.nowObj.getTime())),this._updateData(),this.Update()}},{key:"pause",value:function(){this.config.state.updating=!1,this.config.state.pause=!0,clearTimeout(this.instance)}},{key:"stop",value:function(){this.config.state.updating=!1,clearTimeout(this.instance)}},{key:"destroy",value:function(){this.config.state.updating=!1,clearTimeout(this.instance),this.instance=null,this.config=null}}])&&f(e.prototype,i),n&&f(e,n),t}()}])}));